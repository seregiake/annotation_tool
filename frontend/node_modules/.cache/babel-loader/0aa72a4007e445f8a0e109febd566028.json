{"ast":null,"code":"var _jsxFileName = \"/Users/serenagiachetti/Desktop/projects/annotation_tool/frontend/src/components/ColorCanvas.js\";\nimport React, { Component } from 'react';\n\nclass ColorCanvas extends Component {\n  constructor(props) {\n    super(props);\n    this.canvasRef = React.createRef();\n    this.state = {\n      drawingAreaX: 0,\n      drawingAreaY: 0,\n      clusterID: 0,\n      clusterList: [],\n      pointList: [],\n      draggedPointList: [],\n      draggedMaskPointList: [],\n      mouseDrag: false,\n      color: [255, 0, 0]\n    };\n  }\n\n  loadImage(size) {\n    const canvas = this.canvasRef.current;\n    const context = canvas.getContext('2d');\n    context.canvas.width = size[0];\n    context.canvas.height = size[1];\n  }\n\n  getMousePos(e) {\n    let color_canvas = this.canvasRef.current;\n    let drawingAreaX = color_canvas.getBoundingClientRect().left;\n    let drawingAreaY = color_canvas.getBoundingClientRect().top; // get color_canvas position\n\n    this.setState(prevState => {\n      return {\n        drawingAreaX: drawingAreaX,\n        drawingAreaY: drawingAreaY\n      };\n    }); // mouse click coordinates on the canvas rounded to manage float case\n\n    let mouseX = Math.round(e.pageX - document.body.scrollLeft - document.documentElement.scrollLeft - drawingAreaX),\n        mouseY = Math.round(e.pageY - document.body.scrollTop - document.documentElement.scrollTop - drawingAreaY);\n    return [mouseX, mouseY];\n  }\n\n  clickMouse(event) {\n    let [x, y] = this.getMousePos(event);\n    console.log(\"x: \" + x + \", y: \" + y); //paintAt(x, y);\n  }\n\n  dragStart(event) {//TODO\n  }\n\n  dragOver(event) {//TODO\n  }\n\n  dragEnd(event) {//TODO\n  }\n\n  paintAt(x, y) {\n    takeSelectedColor(\"ann_color_box\"); // takes opacity\n    // let ann_opacity = document.getElementById(\"ann_opacity\");\n    // curColor[3] = Math.round(((ann_opacity.value * 255)/100));\n    // takes pixel RGBA color\n\n    let pixelPos = (startY * canvasWidth + startX) * 4,\n        r = colorImage[pixelPos],\n        g = colorImage[pixelPos + 1],\n        b = colorImage[pixelPos + 2],\n        a = colorImage[pixelPos + 3]; // console.log(\"pixelPos: \" + pixelPos);\n    //console.log(\"r: \" + r + \", g: \" + g + \", b: \" + b + \", a: \" + a);\n    //console.log(\"curColor[0] : \" + curColor[0]  + \", curColor[1] : \" + curColor[1] + \", curColor[2] : \" + curColor[2]  + \", curColor[3] : \" + curColor[3] );\n    // return if you try to recolor the area with the same color and the same opacity\n\n    if (r == curColor[0] && g == curColor[1] && b == curColor[2] && a == curColor[3]) {\n      floodFill(startX, startY, r, g, b, a, [0, 0, 0, 0]);\n      redraw(); // delete the element from clusterList and pointList\n\n      clusterList.splice(clusterList.indexOf(mask[startY][startX]), 1);\n      pointList.splice(clusterList.indexOf(mask[startY][startX]), 1);\n      return;\n    }\n    /*\n    // return if you click on the mask border\n    if (matchOutlineBorder(pixelPos)){\n        console.log(\" click on the mask border \");\n        return\n    }\n     */\n    // call floodFill method and pass to it initial (x,y) and initial RGBA of the pixel clicked\n\n\n    floodFill(startX, startY, r, g, b, a, curColor);\n    redraw();\n    clusterList.push(mask[startY][startX]);\n    pointList.push([startX, startY]);\n  }\n\n  render() {\n    if (this.props.size !== undefined) {\n      const {\n        size\n      } = this.props;\n      this.loadImage(size);\n    }\n\n    return React.createElement(\"canvas\", {\n      id: \"color\",\n      ref: this.canvasRef,\n      style: {\n        zIndex: 3,\n        position: 'absolute',\n        backgroundColor: 'rgba(0, 0, 0, 0.5 )'\n      },\n      onClick: event => this.clickMouse(event),\n      onDragStart: event => this.dragStart(event),\n      onDragOver: event => this.dragOver(event),\n      onDragEnd: event => this.dragEnd(event),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, \"Sorry, your browser doesn't support the <canvas> element.\");\n  }\n\n}\n\nexport default ColorCanvas;","map":{"version":3,"sources":["/Users/serenagiachetti/Desktop/projects/annotation_tool/frontend/src/components/ColorCanvas.js"],"names":["React","Component","ColorCanvas","constructor","props","canvasRef","createRef","state","drawingAreaX","drawingAreaY","clusterID","clusterList","pointList","draggedPointList","draggedMaskPointList","mouseDrag","color","loadImage","size","canvas","current","context","getContext","width","height","getMousePos","e","color_canvas","getBoundingClientRect","left","top","setState","prevState","mouseX","Math","round","pageX","document","body","scrollLeft","documentElement","mouseY","pageY","scrollTop","clickMouse","event","x","y","console","log","dragStart","dragOver","dragEnd","paintAt","takeSelectedColor","pixelPos","startY","canvasWidth","startX","r","colorImage","g","b","a","curColor","floodFill","redraw","splice","indexOf","mask","push","render","undefined","zIndex","position","backgroundColor"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nclass ColorCanvas extends Component {\n\n    constructor (props){\n        super(props);\n        this.canvasRef = React.createRef();\n        this.state = {\n            drawingAreaX: 0,\n            drawingAreaY: 0,\n            clusterID: 0,\n            clusterList: [],\n            pointList: [],\n            draggedPointList: [],\n            draggedMaskPointList: [],\n            mouseDrag: false,\n            color: [255, 0, 0],\n\n        }\n    }\n\n    \n    loadImage(size){\n        const canvas = this.canvasRef.current;\n        const context = canvas.getContext('2d');\n        context.canvas.width = size[0];\n        context.canvas.height = size[1];\n        \n        \n    }\n\n    getMousePos(e){\n       let color_canvas = this.canvasRef.current;\n\n       let drawingAreaX = color_canvas.getBoundingClientRect().left;\n       let drawingAreaY = color_canvas.getBoundingClientRect().top;\n\n        // get color_canvas position\n        this.setState(prevState =>{\n            return {\n                drawingAreaX: drawingAreaX,\n                drawingAreaY: drawingAreaY\n            }\n        })\n\n        // mouse click coordinates on the canvas rounded to manage float case\n        let mouseX = Math.round(e.pageX - document.body.scrollLeft - document.documentElement.scrollLeft - drawingAreaX),\n            mouseY = Math.round(e.pageY - document.body.scrollTop - document.documentElement.scrollTop - drawingAreaY);\n\n        return [mouseX, mouseY];\n    }\n\n    clickMouse(event){\n        let [x, y] = this.getMousePos(event);\n\n        console.log(\"x: \" + x + \", y: \" + y);\n\n        //paintAt(x, y);\n\n    }\n\n    dragStart(event){\n        //TODO\n    }\n\n    dragOver(event){\n        //TODO\n    }\n\n    dragEnd(event){\n        //TODO\n    }\n\n    paintAt(x, y){\n\n        takeSelectedColor(\"ann_color_box\");\n\n        // takes opacity\n        // let ann_opacity = document.getElementById(\"ann_opacity\");\n        // curColor[3] = Math.round(((ann_opacity.value * 255)/100));\n\n        // takes pixel RGBA color\n        let pixelPos = (startY * canvasWidth + startX) * 4,\n            r = colorImage[pixelPos],\n            g = colorImage[pixelPos + 1],\n            b = colorImage[pixelPos + 2],\n            a = colorImage[pixelPos + 3];\n\n        // console.log(\"pixelPos: \" + pixelPos);\n        //console.log(\"r: \" + r + \", g: \" + g + \", b: \" + b + \", a: \" + a);\n        //console.log(\"curColor[0] : \" + curColor[0]  + \", curColor[1] : \" + curColor[1] + \", curColor[2] : \" + curColor[2]  + \", curColor[3] : \" + curColor[3] );\n\n\n        // return if you try to recolor the area with the same color and the same opacity\n        if (r == curColor[0] && g == curColor[1] && b == curColor[2] && a == curColor[3]){\n\n            floodFill(startX, startY, r, g, b, a, [0, 0, 0, 0]);\n            redraw();\n\n            // delete the element from clusterList and pointList\n            clusterList.splice( clusterList.indexOf(mask[startY][startX]), 1 );\n            pointList.splice( clusterList.indexOf(mask[startY][startX]), 1);\n\n            return\n        }\n\n        /*\n        // return if you click on the mask border\n        if (matchOutlineBorder(pixelPos)){\n            console.log(\" click on the mask border \");\n            return\n        }\n         */\n\n        // call floodFill method and pass to it initial (x,y) and initial RGBA of the pixel clicked\n        floodFill(startX, startY, r, g, b, a, curColor);\n        redraw();\n\n        clusterList.push(mask[startY][startX]);\n        pointList.push([startX, startY]);\n    }\n\n\n    \n   render() {\n   \n    if (this.props.size !==undefined) {\n        const { size } = this.props;\n        this.loadImage(size);\n        \n    } \n\n        return(\n            <canvas id=\"color\"\n                    ref={this.canvasRef}\n                    style={{ zIndex: 3, position:'absolute', backgroundColor:'rgba(0, 0, 0, 0.5 )'}}\n                    onClick={(event) => this.clickMouse(event)}\n                    onDragStart={(event) => this.dragStart(event)}\n                    onDragOver={(event) => this.dragOver(event)}\n                    onDragEnd={(event) => this.dragEnd(event)}\n\n            >\n                Sorry, your browser doesn't support the &lt;canvas&gt; element. \n            </canvas> \n        )\n\n    \n    \n    \n    }\n    \n}\nexport default ColorCanvas;"]},"metadata":{},"sourceType":"module"}